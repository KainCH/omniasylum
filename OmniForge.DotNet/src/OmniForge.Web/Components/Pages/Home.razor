@page "/"
@using Microsoft.AspNetCore.Components.Authorization
@inject NavigationManager NavigationManager
@inject AuthenticationStateProvider AuthenticationStateProvider

@code {
  protected override async Task OnInitializedAsync()
  {
    var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
    var user = authState.User;

    if (user.Identity?.IsAuthenticated == true)
    {
      NavigationManager.NavigateTo("/portal", forceLoad: true);
      return;
    }

    // If login isn't detected (or token refresh forced sign-out), route to login.
    NavigationManager.NavigateTo("/auth/twitch", forceLoad: true);
  }
}
