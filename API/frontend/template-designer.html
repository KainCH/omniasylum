<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Template Designer - OmniAsylum Stream Counter</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
    }

    .sidebar {
      width: 350px;
      background: rgba(255, 255, 255, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      padding: 20px;
      overflow-y: auto;
      border-right: 1px solid rgba(0, 0, 0, 0.1);
    }

    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .preview-header {
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 15px 20px;
      display: flex;
      justify-content: between;
      align-items: center;
    }

    .preview-container {
      flex: 1;
      background: #1a1a1a;
      position: relative;
      overflow: hidden;
    }

    .template-preview {
      position: absolute;
      top: 20px;
      right: 20px;
      background: var(--bg-color, rgba(0, 0, 0, 0.8));
      border: 2px solid var(--border-color, #d4af37);
      border-radius: 8px;
      padding: 15px;
      min-width: 200px;
      font-family: var(--font-primary, 'Arial, sans-serif');
      color: var(--text-color, white);
    }

    .counter-item {
      display: flex;
      align-items: center;
      margin: 8px 0;
      padding: 5px;
      border-radius: 5px;
      transition: all 0.3s ease;
    }

    .counter-icon {
      font-size: 24px;
      margin-right: 10px;
    }

    .counter-info {
      display: flex;
      flex-direction: column;
    }

    .counter-label {
      font-size: 12px;
      opacity: 0.8;
    }

    .counter-value {
      font-size: 18px;
      font-weight: bold;
      color: var(--accent-color, #fff);
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 600;
      color: #333;
    }

    .form-group input[type="text"],
    .form-group input[type="color"],
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
    }

    .color-input {
      height: 40px;
      cursor: pointer;
    }

    .checkbox-group {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 5px;
    }

    .checkbox-item {
      display: flex;
      align-items: center;
    }

    .checkbox-item input {
      margin-right: 8px;
    }

    .section-header {
      background: #f8f9fa;
      padding: 10px;
      margin: 0 -20px 20px -20px;
      border-left: 4px solid #667eea;
      font-weight: 600;
      color: #333;
    }

    .button-group {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .btn-primary {
      background: #667eea;
      color: white;
    }

    .btn-primary:hover {
      background: #5a6fd8;
    }

    .btn-secondary {
      background: #6c757d;
      color: white;
    }

    .btn-secondary:hover {
      background: #5a6268;
    }

    .preset-templates {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 10px;
    }

    .preset-template {
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      cursor: pointer;
      text-align: center;
      transition: all 0.3s ease;
      font-size: 12px;
    }

    .preset-template:hover {
      border-color: #667eea;
      background: #f8f9fa;
    }

    .sound-upload {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .sound-upload input[type="file"] {
      flex: 1;
    }

    .play-btn {
      background: #28a745;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 3px;
      cursor: pointer;
      font-size: 12px;
    }

    /* Animation preview styles */
    .animate-bounce {
      animation: bounce 0.5s ease-in-out;
    }

    .animate-shake {
      animation: shake 0.5s ease-in-out;
    }

    .animate-glow {
      animation: glow 2s ease-in-out infinite;
    }

    @keyframes bounce {

      0%,
      20%,
      50%,
      80%,
      100% {
        transform: translateY(0);
      }

      40% {
        transform: translateY(-10px);
      }

      60% {
        transform: translateY(-5px);
      }
    }

    @keyframes shake {

      0%,
      100% {
        transform: translateX(0);
      }

      25% {
        transform: translateX(-5px);
      }

      75% {
        transform: translateX(5px);
      }
    }

    @keyframes glow {

      0%,
      100% {
        box-shadow: 0 0 5px var(--accent-color);
      }

      50% {
        box-shadow: 0 0 20px var(--accent-color);
      }
    }
  </style>
</head>

<body>
  <div class="sidebar">
    <h2>Template Designer</h2>

    <div class="form-group">
      <label>Template Name</label>
      <input type="text" id="templateName" value="My Custom Template" placeholder="Enter template name">
    </div>

    <div class="section-header">Quick Presets</div>
    <div class="preset-templates">
      <div class="preset-template" onclick="loadPreset('dark')">
        <strong>Dark Theme</strong><br>
        Black & Purple
      </div>
      <div class="preset-template" onclick="loadPreset('light')">
        <strong>Light Theme</strong><br>
        White & Blue
      </div>
      <div class="preset-template" onclick="loadPreset('gaming')">
        <strong>Gaming</strong><br>
        Neon Colors
      </div>
      <div class="preset-template" onclick="loadPreset('minimal')">
        <strong>Minimal</strong><br>
        Clean & Simple
      </div>
    </div>

    <div class="section-header">Colors</div>
    <div class="form-group">
      <label for="primaryColor">Primary Color</label>
      <input type="color" id="primaryColor" class="color-input" value="#8B0000"
        title="Select primary color for the template" onchange="updatePreview()">
    </div>
    <div class="form-group">
      <label for="secondaryColor">Secondary Color</label>
      <input type="color" id="secondaryColor" class="color-input" value="#DC143C"
        title="Select secondary color for the template" onchange="updatePreview()">
    </div>
    <div class="form-group">
      <label for="backgroundColor">Background Color</label>
      <input type="color" id="backgroundColor" class="color-input" value="#1a0000"
        title="Select background color for the template" onchange="updatePreview()">
    </div>
    <div class="form-group">
      <label for="textColor">Text Color</label>
      <input type="color" id="textColor" class="color-input" value="#FFFFFF" title="Select text color for the template"
        onchange="updatePreview()">
    </div>
    <div class="form-group">
      <label for="accentColor">Accent Color</label>
      <input type="color" id="accentColor" class="color-input" value="#FF6B6B"
        title="Select accent color for the template" onchange="updatePreview()">
    </div>

    <div class="section-header">Fonts</div>
    <div class="form-group">
      <label for="primaryFont">Primary Font</label>
      <select id="primaryFont" title="Select primary font for the template" onchange="updatePreview()">
        <option value="Creepster, cursive">Creepster (Horror)</option>
        <option value="Inter, sans-serif">Inter (Modern)</option>
        <option value="Roboto, sans-serif">Roboto</option>
        <option value="Arial, sans-serif">Arial</option>
        <option value="'Times New Roman', serif">Times New Roman</option>
        <option value="'Courier New', monospace">Courier New</option>
      </select>
    </div>

    <div class="section-header">Animations</div>
    <div class="checkbox-group">
      <div class="checkbox-item">
        <input type="checkbox" id="bounceOnUpdate" onchange="updatePreview()">
        <label for="bounceOnUpdate">Bounce on Update</label>
      </div>
      <div class="checkbox-item">
        <input type="checkbox" id="fadeEffects" checked onchange="updatePreview()">
        <label for="fadeEffects">Fade Effects</label>
      </div>
      <div class="checkbox-item">
        <input type="checkbox" id="glowEffect" onchange="updatePreview()">
        <label for="glowEffect">Glow Effect</label>
      </div>
      <div class="checkbox-item">
        <input type="checkbox" id="screenShake" onchange="updatePreview()">
        <label for="screenShake">Screen Shake</label>
      </div>
    </div>

    <div class="section-header">Sound Effects</div>
    <div class="form-group">
      <label for="deathSound">Death Sound</label>
      <div class="sound-upload">
        <input type="file" id="deathSound" accept="audio/*" title="Upload sound effect for death counter">
        <button class="play-btn" onclick="playSound('death')">â–¶</button>
      </div>
    </div>
    <div class="form-group">
      <label for="swearSound">Swear Sound</label>
      <div class="sound-upload">
        <input type="file" id="swearSound" accept="audio/*" title="Upload sound effect for swear counter">
        <button class="play-btn" onclick="playSound('swear')">â–¶</button>
      </div>
    </div>
    <div class="form-group">
      <label for="milestoneSound">Milestone Sound</label>
      <div class="sound-upload">
        <input type="file" id="milestoneSound" accept="audio/*" title="Upload sound effect for milestone achievements">
        <button class="play-btn" onclick="playSound('milestone')">â–¶</button>
      </div>
    </div>

    <div class="button-group">
      <button class="btn btn-primary" onclick="saveTemplate()">Save Template</button>
      <button class="btn btn-secondary" onclick="exportTemplate()">Export JSON</button>
    </div>
  </div>

  <div class="main-content">
    <div class="preview-header">
      <h3>Live Preview</h3>
      <div>
        <button class="btn btn-secondary" onclick="testAnimation('bounce')">Test Bounce</button>
        <button class="btn btn-secondary" onclick="testAnimation('shake')">Test Shake</button>
        <button class="btn btn-secondary" onclick="testAnimation('glow')">Test Glow</button>
      </div>
    </div>

    <div class="preview-container">
      <div class="template-preview" id="preview">
        <div class="counter-item">
          <div class="counter-icon">ðŸ’€</div>
          <div class="counter-info">
            <div class="counter-label">Deaths</div>
            <div class="counter-value">42</div>
          </div>
        </div>
        <div class="counter-item">
          <div class="counter-icon">ðŸ¤¬</div>
          <div class="counter-info">
            <div class="counter-label">Swears</div>
            <div class="counter-value">23</div>
          </div>
        </div>
        <div class="counter-item">
          <div class="counter-icon">ðŸ˜±</div>
          <div class="counter-info">
            <div class="counter-label">Screams</div>
            <div class="counter-value">15</div>
          </div>
        </div>
        <div class="counter-item">
          <div class="counter-icon">ðŸ’Ž</div>
          <div class="counter-info">
            <div class="counter-label">Bits</div>
            <div class="counter-value">150</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    let currentTemplate = {};

    function updatePreview() {
      const preview = document.getElementById('preview');
      const primaryColor = document.getElementById('primaryColor').value;
      const secondaryColor = document.getElementById('secondaryColor').value;
      const backgroundColor = document.getElementById('backgroundColor').value;
      const textColor = document.getElementById('textColor').value;
      const accentColor = document.getElementById('accentColor').value;
      const primaryFont = document.getElementById('primaryFont').value;

      // Update CSS custom properties
      preview.style.setProperty('--bg-color', backgroundColor);
      preview.style.setProperty('--border-color', primaryColor);
      preview.style.setProperty('--text-color', textColor);
      preview.style.setProperty('--accent-color', accentColor);
      preview.style.setProperty('--font-primary', primaryFont);

      // Apply glow effect if enabled
      if (document.getElementById('glowEffect').checked) {
        preview.classList.add('animate-glow');
      } else {
        preview.classList.remove('animate-glow');
      }

      // Update current template config
      currentTemplate = {
        name: document.getElementById('templateName').value,
        config: {
          colors: {
            primary: primaryColor,
            secondary: secondaryColor,
            background: backgroundColor,
            text: textColor,
            accent: accentColor
          },
          fonts: {
            primary: primaryFont,
            secondary: 'Arial, sans-serif'
          },
          animations: {
            bounceOnUpdate: document.getElementById('bounceOnUpdate').checked,
            fadeEffects: document.getElementById('fadeEffects').checked,
            glowEffect: document.getElementById('glowEffect').checked,
            screenShake: document.getElementById('screenShake').checked
          },
          sounds: {
            death: 'scream.mp3',
            swear: 'bleep.mp3',
            milestone: 'creepy_bell.mp3'
          }
        }
      };
    }

    function loadPreset(preset) {
      const presets = {
        dark: {
          primaryColor: '#8B0000',
          secondaryColor: '#DC143C',
          backgroundColor: '#1a0000',
          textColor: '#FFFFFF',
          accentColor: '#FF6B6B',
          primaryFont: 'Creepster, cursive'
        },
        light: {
          primaryColor: '#6366f1',
          secondaryColor: '#8b5cf6',
          backgroundColor: '#ffffff',
          textColor: '#1f2937',
          accentColor: '#3b82f6',
          primaryFont: 'Inter, sans-serif'
        },
        gaming: {
          primaryColor: '#00ff88',
          secondaryColor: '#ff0088',
          backgroundColor: '#0a0a0a',
          textColor: '#00ff88',
          accentColor: '#ff0088',
          primaryFont: 'Roboto, sans-serif'
        },
        minimal: {
          primaryColor: '#333333',
          secondaryColor: '#666666',
          backgroundColor: '#f8f9fa',
          textColor: '#333333',
          accentColor: '#007bff',
          primaryFont: 'Arial, sans-serif'
        }
      };

      const config = presets[preset];
      if (config) {
        Object.keys(config).forEach(key => {
          const element = document.getElementById(key);
          if (element) {
            element.value = config[key];
          }
        });
        updatePreview();
      }
    }

    function testAnimation(type) {
      const preview = document.getElementById('preview');
      preview.classList.remove('animate-bounce', 'animate-shake', 'animate-glow');

      setTimeout(() => {
        preview.classList.add(`animate-${type}`);
        setTimeout(() => {
          preview.classList.remove(`animate-${type}`);
        }, 1000);
      }, 50);
    }

    function playSound(type) {
      // Placeholder for sound testing
      console.log(`Playing ${type} sound`);
    }

    function saveTemplate() {
      fetch('/api/templates/custom', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${localStorage.getItem('authToken')}`
        },
        body: JSON.stringify({
          ...currentTemplate,
          makeActive: true
        })
      })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            alert('Template saved successfully!');
          } else {
            alert('Error saving template: ' + data.error);
          }
        })
        .catch(error => {
          console.error('Error:', error);
          alert('Failed to save template');
        });
    }

    function exportTemplate() {
      const dataStr = JSON.stringify(currentTemplate, null, 2);
      const dataBlob = new Blob([dataStr], { type: 'application/json' });
      const url = URL.createObjectURL(dataBlob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `${currentTemplate.name.replace(/[^a-z0-9]/gi, '_')}.json`;
      link.click();
    }

    // Initialize
    updatePreview();
  </script>
</body>

</html>
